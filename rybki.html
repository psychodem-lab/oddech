<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Akwarium Spokoju - Realistyczne Ryby</title>
    <style>
        body { background: #020508; margin: 0; overflow: hidden; display: flex; align-items: center; justify-content: center; height: 100vh; touch-action: none; }
        canvas { 
            background: linear-gradient(180deg, #102131 0%, #050a0f 100%);
            box-shadow: 0 0 100px rgba(0,0,0,0.8);
            border: 10px solid #222;
            border-radius: 15px;
            max-width: 98vw;
            max-height: 90vh;
        }
    </style>
</head>
<body>

<canvas id="aquariumCanvas" width="1000" height="600"></canvas>

<script>
    const canvas = document.getElementById("aquariumCanvas");
    const ctx = canvas.getContext("2d");

    let mouse = { x: -100, y: -100, active: false };
    let fishes = [];
    let bubbles = [];
    let plants = [];

    const types = [
        { name: 'skalar', color: '#e0e0e0', accent: '#333', size: 45, speed: 0.6 },
        { name: 'mieczyk', color: '#ff6600', accent: '#cc4400', size: 40, speed: 1.2 },
        { name: 'molinezja', color: '#111', accent: '#444', size: 35, speed: 0.9 },
        { name: 'gupik', color: '#44ccff', accent: '#ff44aa', size: 25, speed: 1.5 }
    ];

    // Rośliny - generowane raz, aby nie migotały
    for(let i=0; i<12; i++) {
        plants.push({
            x: Math.random() * canvas.width,
            h: 150 + Math.random() * 250,
            thickness: 8 + Math.random() * 6,
            phase: Math.random() * Math.PI * 2
        });
    }

    class Fish {
        constructor() {
            this.type = types[Math.floor(Math.random() * types.length)];
            this.x = Math.random() * canvas.width;
            this.y = Math.random() * canvas.height;
            this.targetX = Math.random() * canvas.width;
            this.targetY = Math.random() * canvas.height;
            this.velX = 0;
            this.velY = 0;
            this.flip = 1;
            this.changeTargetIn = Math.random() * 200;
        }

        update() {
            // Decyzja o celu
            if (mouse.active) {
                this.targetX = mouse.x;
                this.targetY = mouse.y;
            } else {
                this.changeTargetIn--;
                if (this.changeTargetIn <= 0) {
                    this.targetX = Math.random() * canvas.width;
                    this.targetY = Math.random() * canvas.height;
                    this.changeTargetIn = 150 + Math.random() * 300;
                }
            }

            // Ruch w stronę celu
            let dx = this.targetX - this.x;
            let dy = this.targetY - this.y;
            let dist = Math.sqrt(dx*dx + dy*dy);

            if (dist > 5) {
                this.velX += (dx / dist) * 0.02 * this.type.speed;
                this.velY += (dy / dist) * 0.02 * this.type.speed;
            }

            // Ograniczenie prędkości (realistyczne hamowanie)
            this.velX *= 0.985;
            this.velY *= 0.985;

            this.x += this.velX;
            this.y += this.velY;

            // Kierunek
            if (this.velX > 0.1) this.flip = 1;
            if (this.velX < -0.1) this.flip = -1;
        }

        draw() {
            ctx.save();
            ctx.translate(this.x, this.y);
            ctx.scale(this.flip, 1);
            
            const s = this.type.size;
            ctx.fillStyle = this.type.color;
            ctx.strokeStyle = this.type.accent;
            ctx.lineWidth = 1;

            if (this.type.name === 'skalar') {
                // Skalar - Trójkątny profil
                ctx.beginPath();
                ctx.moveTo(s*0.5, 0); // Pysk
                ctx.lineTo(-s*0.5, -s); // Góra
                ctx.lineTo(-s*0.2, 0); // Wcięcie ogona
                ctx.lineTo(-s*0.5, s); // Dół
                ctx.closePath();
                ctx.fill();
                ctx.stroke();
            } else if (this.type.name === 'mieczyk') {
                // Mieczyk - smukły z mieczem na dole
                ctx.beginPath();
                ctx.ellipse(0, 0, s*0.8, s*0.3, 0, 0, Math.PI*2);
                ctx.fill();
                ctx.stroke();
                // Ogon i miecz
                ctx.beginPath();
                ctx.moveTo(-s*0.6, 0);
                ctx.lineTo(-s*1.8, s*0.5); // Długi miecz
                ctx.lineTo(-s*0.8, s*0.1);
                ctx.fillStyle = this.type.accent;
                ctx.fill();
            } else if (this.type.name === 'molinezja') {
                // Molinezja - krępa
                ctx.beginPath();
                ctx.ellipse(0, 0, s*0.8, s*0.45, 0, 0, Math.PI*2);
                ctx.fill();
                ctx.stroke();
                ctx.beginPath();
                ctx.moveTo(-s*0.7, 0);
                ctx.lineTo(-s*1.3, -s*0.5);
                ctx.lineTo(-s*1.3, s*0.5);
                ctx.fill();
            } else { // Gupik
                ctx.beginPath();
                ctx.ellipse(0, 0, s*0.6, s*0.3, 0, 0, Math.PI*2);
                ctx.fill();
                ctx.fillStyle = this.type.accent;
                ctx.beginPath(); // Wielki wachlarzowaty ogon
                ctx.moveTo(-s*0.5, 0);
                ctx.quadraticCurveTo(-s*1.8, -s*1.2, -s*1.8, 0);
                ctx.quadraticCurveTo(-s*1.8, s*1.2, -s*0.5, 0);
                ctx.fill();
            }

            // Oko
            ctx.fillStyle = "black";
            ctx.beginPath();
            ctx.arc(s*0.3, -s*0.1, 2, 0, Math.PI*2);
            ctx.fill();

            ctx.restore();
        }
    }

    // Klasa bąbelków
    class Bubble {
        constructor() {
            this.x = Math.random() * canvas.width;
            this.y = canvas.height + 20;
            this.r = 2 + Math.random() * 5;
            this.speed = 0.5 + Math.random() * 1.5;
            this.osc = Math.random() * 10;
        }
        update() {
            this.y -= this.speed;
            this.x += Math.sin(this.y * 0.05 + this.osc) * 0.5;
        }
        draw() {
            ctx.beginPath();
            ctx.strokeStyle = "rgba(255, 255, 255, 0.3)";
            ctx.arc(this.x, this.y, this.r, 0, Math.PI*2);
            ctx.stroke();
        }
    }

    for(let i=0; i<15; i++) fishes.push(new Fish());

    function drawWorld() {
        const time = Date.now() * 0.001;
        
        // Wodorosty
        ctx.strokeStyle = "#1a3322";
        ctx.lineCap = "round";
        plants.forEach(p => {
            ctx.lineWidth = p.thickness;
            ctx.beginPath();
            ctx.moveTo(p.x, canvas.height);
            let sway = Math.sin(time + p.phase) * 20;
            ctx.bezierCurveTo(p.x + sway, canvas.height - p.h/3, p.x - sway, canvas.height - p.h*0.6, p.x + sway/2, canvas.height - p.h);
            ctx.stroke();
        });

        // Bąbelki
        if (Math.random() < 0.08) bubbles.push(new Bubble());
        for (let i = bubbles.length - 1; i >= 0; i--) {
            bubbles[i].update();
            bubbles[i].draw();
            if (bubbles[i].y < -20) bubbles.splice(i, 1);
        }
    }

    function animate() {
        ctx.fillStyle = "rgba(10, 25, 40, 0.5)"; // Lekkie smużenie
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        drawWorld();

        fishes.forEach(f => {
            f.update();
            f.draw();
        });

        requestAnimationFrame(animate);
    }

    // Obsługa interakcji
    const inputStart = (e) => { mouse.active = true; inputMove(e); };
    const inputEnd = () => { mouse.active = false; };
    const inputMove = (e) => {
        const rect = canvas.getBoundingClientRect();
        const clientX = e.touches ? e.touches[0].clientX : e.clientX;
        const clientY = e.touches ? e.touches[0].clientY : e.clientY;
        mouse.x = (clientX - rect.left) * (canvas.width / rect.width);
        mouse.y = (clientY - rect.top) * (canvas.height / rect.height);
    };

    canvas.addEventListener('mousedown', inputStart);
    canvas.addEventListener('mousemove', inputMove);
    window.addEventListener('mouseup', inputEnd);
    canvas.addEventListener('touchstart', inputStart);
    canvas.addEventListener('touchmove', inputMove);
    window.addEventListener('touchend', inputEnd);

    animate();
</script>

</body>
</html>
